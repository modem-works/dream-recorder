sequenceDiagram
    autonumber

    participant U as User ğŸ§”
    participant TS as Touch Sensor ğŸ”˜
    participant GPIO as GPIO Service ğŸ”„
    participant DM as Dream Machine ğŸ–¥ï¸
    participant OpenAI as OpenAI ğŸ¤–
    participant LL as LumaLabs ğŸ¤–
    
    Note over U,DM: Device in Clock View
    U ->> TS: Double tap ğŸ‘†ğŸ‘† (start recording)
    TS ->> GPIO: Detects double tap pattern
    GPIO ->> DM: Sends start recording request
    DM ->> U: Shows recording UI ğŸ”´
    U ->> DM: Voices dream ğŸ—£ï¸
    U ->> TS: Single tap ğŸ‘† (stop recording)
    TS ->> GPIO: Detects single tap pattern
    GPIO ->> DM: Sends stop recording request
    
    Note over DM,OpenAI: Processing Dream
    DM ->> OpenAI: Sends dream voice for STT ğŸ¶
    OpenAI -->> DM: Returns voice text ğŸ“ƒ
    DM ->> U: Shows transcription ğŸ“
    
    DM ->> OpenAI: Sends voice text for Video Prompt creation ğŸ“ƒ
    OpenAI -->> DM: Returns Video Prompt ğŸ“ƒ
    
    DM ->> LL: Sends Video Prompt for video creation ğŸ“ƒ
    DM -->> DM: Awaits response ğŸ’¤
    
    LL -->> DM: Returns video URL ğŸ”—
    DM ->> U: Plays video ğŸ“ºï¸
    
    Note over U,DM: Viewing Dreams
    U ->> TS: Single tap ğŸ‘† (view dream)
    TS ->> GPIO: Detects single tap pattern
    GPIO ->> DM: Sends show dream request
    DM ->> U: Plays dream video ğŸ“½ï¸
    U ->> TS: Single tap ğŸ‘† (next dream)
    TS ->> GPIO: Detects single tap pattern
    GPIO ->> DM: Sends next dream request
    DM ->> U: Plays next dream video ğŸ“½ï¸
    U ->> TS: Double tap ğŸ‘†ğŸ‘† (return to clock)
    TS ->> GPIO: Detects double tap pattern
    GPIO ->> DM: Sends return to clock request
    DM ->> U: Shows clock view ğŸ•

    % DM -->> DM: Proprietary conversion â‰ï¸