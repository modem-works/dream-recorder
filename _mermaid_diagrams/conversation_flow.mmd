sequenceDiagram
    autonumber

    participant U as User ğŸ§”
    participant TS as Touch Sensor ğŸ”˜
    participant GPIO as GPIO Service ğŸ”„
    participant DM as Dream Machine ğŸ–¥ï¸
    participant OpenAI as OpenAI ğŸ¤–
    participant LL as LumaLabs ğŸ¤–
    
    Note over U,DM: Device Idle
    U ->> TS: Single tap ğŸ‘† (wake device)
    TS ->> GPIO: Detects single tap pattern
    GPIO ->> DM: Sends wake request
    DM ->> U: Displays ready UI ğŸ¬
    
    Note over U,DM: Recording Dream
    U ->> TS: Long press ğŸ‘‡ (start recording)
    TS ->> GPIO: Detects long press pattern
    GPIO ->> DM: Sends start recording request
    DM ->> U: Shows recording UI ğŸ”´
    U ->> DM: Voices dream ğŸ—£ï¸
    U ->> TS: Releases button ğŸ‘† (stop recording)
    TS ->> GPIO: Detects long press release
    GPIO ->> DM: Sends stop recording request
    
    Note over DM,OpenAI: Processing Dream
    DM ->> OpenAI: Sends dream voice for STT ğŸ¶
    OpenAI -->> DM: Returns voice text ğŸ“ƒ
    DM ->> U: Shows transcription ğŸ“
    
    DM ->> OpenAI: Sends voice text for Video Prompt creation ğŸ“ƒ
    OpenAI -->> DM: Returns Video Prompt ğŸ“ƒ
    
    DM ->> LL: Sends Video Prompt for video creation ğŸ“ƒ
    DM -->> DM: Awaits response ğŸ’¤
    
    LL -->> DM: Returns video URL ğŸ”—
    DM ->> U: Plays video ğŸ“ºï¸
    
    Note over U,DM: Viewing Previous Dreams
    U ->> TS: Double tap ğŸ‘†ğŸ‘† (view previous)
    TS ->> GPIO: Detects double tap pattern
    GPIO ->> DM: Sends show previous dream request
    DM ->> U: Plays previous dream video ğŸ“½ï¸

    % DM -->> DM: Proprietary conversion â‰ï¸